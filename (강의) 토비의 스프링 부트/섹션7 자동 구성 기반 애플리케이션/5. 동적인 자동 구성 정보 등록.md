인프라 빈이 추가될 때마다 @EnableMyAutoConfiguration을 수정하지 않고도 동적으로 구성 정보가 등록될 수 있게 만드는 것이 이번 강의의 목표다.

ImportSelector 인터페이스를 구현하면 configuration 클래스들을 프로그램에서 동적으로 가져올 수 있다. 참고로 실제 구현할 것은 ImportSelector를 확장한 DeferredImportSelector다.

DeferredImportSelector 사용 이유는 구성 클래스의 빈 등록 작업을 먼저 끝내고 동적으로 구성 클래스를 import하도록 설계됐기 때문이다.

```java
public class MyAutoConfigImportSelector implements DeferredImportSelector {
	@Override
	public String[] selectImports(AnnotationMetadata importingClassMetadata) {
		return new String[] {
			"tobyspring.config.autoconfig.DispatcherServletConfig",
			"tobyspring.config.autoconfig.TomcatWebServerConfig"
		};
	}
}
```

위 코드와 같이 import할 구성 정보 클래스들을 문자열 배열로 반환하도록 한다.

```java
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.TYPE)
@Import(MyAutoConfigImportSelector.class)
public @interface EnableMyAutoconfiguration {
}
```

@Import 부분에 새로 만든 Selector를 읽을 수 있도록 변경한다.

일단 MyAutoConfigImportSelector를 읽고 메서드 내부에서 반환하는 문자열 배열을 보고 구성 정보를 등록하는 방식으로 동작한다.

하지만 이 방식도 구성 클래스들을 하드 코딩한다는 단점이 남아있다. 새로운 구성 클래스가 생기면 MyAutoConfigImportSelector를 수정해줘야한다.
