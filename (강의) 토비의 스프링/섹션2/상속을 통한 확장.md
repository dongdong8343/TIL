- 앞에서 메서드로 분리하면 생기는 단점에 대해 얘기했었다.

- 그래서 클래스로 분리를 해봤다. 이번에는 상속을 통한 확장을 사용해봤다.

- 그 이유는 내가 작성한 코드가 너무 잘만들어서 다른 사람들도 가져다 쓰고 싶어한다. 그리고 가져다 사용하는 사람들마다 특정 메서드에 대한 동작을 본인 상황에 맞게 수정하고 싶어한다.

  이런 경우 특정 메서드를 추상 메서드로 바꾸고 해당 추상 클래스를 상속해서 추상 메서드를 구현하는 방식으로 유도할 수 있다.

  ```java
  abstract public class PaymentService {

      public Payment prepare(Long orderId, String currency, BigDecimal foreignCurrencyAmount) throws
          IOException {
          BigDecimal exRate = getExRate(currency);

          BigDecimal convertedAmount = foreignCurrencyAmount.multiply(exRate);
          LocalDateTime validUntil = LocalDateTime.now().plusMinutes(30);

          return new Payment(orderId, currency, foreignCurrencyAmount, exRate, convertedAmount, validUntil);
      }

      abstract BigDecimal getExRate(String currency) throws IOException;
  }
  ```

  ```java
  public class WebApiExRatePaymentService extends PaymentService {

      @Override
      BigDecimal getExRate(String currency) throws IOException {
          URL url = new URL("https://open.er-api.com/v6/latest/" + currency);
          HttpURLConnection connection = (HttpURLConnection)url.openConnection();
          BufferedReader br = new BufferedReader(
              new InputStreamReader(connection.getInputStream()));
          String response = br.lines().collect(Collectors.joining());
          br.close();

          ObjectMapper mapper = new ObjectMapper();
          ExRateData data = mapper.readValue(response, ExRateData.class);
          return data.rates().get("KRW");
      }
  }
  ```

  ```java
  public class Client {

      public static void main(String[] args) throws IOException {
          PaymentService paymentService = new SimpleExRatePaymentService();
          Payment payment = paymentService.prepare(100L, "USD", BigDecimal.valueOf(50.7));
          System.out.println(payment);
      }

  }
  ```

- 이렇게 하면 단점이 발생한다. 만약 특정 상황이 추가돼서 추상 메서드가 추가로 필요하다고 가정해보자.

  그럼 추상 메서드가 추가가 되고 그 추상 메서드를 구현하는 클래스는 무수히 많아질 수 있다. 즉 추상 메서드의 조합이 매우 많아질 수 있다.

  이렇게 되면 장기적으로 봤을 때 이 방법도 좋은 방법은 아닌 것 같다.

  이를 해결하기 위해 추상 클래스를 통해 클래스를 생성하는 것이 아니라 별도의 클래스로 분리하는 방법이 있다. 이건 다음에 파일에 작성한다.
