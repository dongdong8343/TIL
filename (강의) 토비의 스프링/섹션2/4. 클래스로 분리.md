- 클래스로 분리하는 방법을 알아보자.

- 추상 클래스로 상속하는 방법이 아니라 별도의 클래스를 만들어서 가져다 사용하는 사람들 입맛에 맞게 수정하라고 했다.

  그럼 아래와 같이 새로운 클래스들이 생겨날 것이다.

  ```java
  public class PaymentService {

      private final WebApiExRateProvider exRateProvider;

      public PaymentService() {
          this.exRateProvider = new WebApiExRateProvider();
      }

      public Payment prepare(Long orderId, String currency, BigDecimal foreignCurrencyAmount) throws
          IOException {

          BigDecimal exRate = exRateProvider.getWebExRate(currency);

          BigDecimal convertedAmount = foreignCurrencyAmount.multiply(exRate);
          LocalDateTime validUntil = LocalDateTime.now().plusMinutes(30);

          return new Payment(orderId, currency, foreignCurrencyAmount, exRate, convertedAmount, validUntil);
      }
  }
  ```

  ```java
  public class WebApiExRateProvider {
      BigDecimal getWebExRate(String currency) throws IOException {
          URL url = new URL("https://open.er-api.com/v6/latest/" + currency);
          HttpURLConnection connection = (HttpURLConnection)url.openConnection();
          BufferedReader br = new BufferedReader(
              new InputStreamReader(connection.getInputStream()));
          String response = br.lines().collect(Collectors.joining());
          br.close();

          ObjectMapper mapper = new ObjectMapper();
          ExRateData data = mapper.readValue(response, ExRateData.class);
          return data.rates().get("KRW");
      }
  }
  ```

  ```java
  public class SimpleExRateProvider {
      BigDecimal getExRate(String currency) throws IOException {
          if(currency.equals("USD"))
              return BigDecimal.valueOf(1000);

          throw new IllegalArgumentException("지원되지 않는 통화입니다.");
      }
  }
  ```

  그리고 Service에서 각자의 입맛에 맞게 만든 Provider 객체를 prepare라는 메서드를 호출하기 전에 집어넣어줘야한다.

  하지만 위에서 보면 알 수 있듯이 사람들마다 클래스를 만들고 메서드 명을 자기 마음대로 하는 것을 볼 수 있다.

  이러면 사람들이 새로운 클래스를 만들 때마다 Service 클래스의 코드를 변경해줘야 한다.

  이런 수정 작업이 매번 일어난다면 굉장히 비효율적인 코드가 될 수 밖에 없다.

  그럼 이 방법을 해결하기 위해서는??

  인터페이스를 활용해서 메서드의 이름을 하나로 통일시키는 것이다.

  이 방법은 다음 파일에.
