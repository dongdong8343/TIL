내가 만약 Tomcat과 같은 서블릿 컨테이너를 만들었고 그걸 적용하고 싶다면?

사용자 구성 정보에 자동 구성 정보에 등록되는 것과 같은 기술과 관련된 인프 스트럭처 빈을 직접 정의하면 된다.

그래서 일단 아래와 같이 사용자 구성 정보를 만들었다.

```java
@Configuration(proxyBeanMethods = false)
public class WebServerConfiguration {
	@Bean
	ServletWebServerFactory customerWebServerFactory() {
		TomcatServletWebServerFactory serverFactory = new TomcatServletWebServerFactory();
		serverFactory.setPort(9090);
		return serverFactory;
	}
}
```

그리고 애플리케이션을 실행하면 당연히 실행이 안된다. 서블릿 컨테이너가 2개가 등록이 되는데 어떤걸 사용해야할지 몰라서다.

Tomcat을 사용하는 구성 클래스에 Tomcat을 만드는 메서드에 @ConditionalOnMissingBean을 붙이면 해당 메서드에서 반환하는
`ServletWebServerFactory` 가 없다면 메서드가 정상적으로 동작하고 이미 있다면 메서드가 동작안하는 방식이다.

```java
@MyAutoConfiguration
@ConditionalMyOnClass("org.apache.catalina.startup.Tomcat")
public class TomcatWebServerConfig {
	@Bean("tomcatWebServerFactory")
	@ConditionalOnMissingBean
	public ServletWebServerFactory servletWebServerFactory() {
		return new TomcatServletWebServerFactory();
	}
}
```

이렇게 될 수 있는 이유는 사용자 구성 정보가 먼저 등록이 되고 자동 구성 정보가 등록되기 때문이다.
