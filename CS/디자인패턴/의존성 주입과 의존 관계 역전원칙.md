## 의존성주입과 의존관계역전원칙

### 의존성 주입(DI)

- 의존성 주입자가 의존성을 가로채 메인 모듈이 ‘간접’적으로 의존성을 주입하는 방식
- 메인 모듈과 하위 모듈 간의 결합을 느슨하게 해서 모듈 교체가 용이하다.
- 의존하고 있는 모듈이 바뀌면 해당 모듈에도 영향을 끼치게 됨

```java
interface PaymentProcessor {
    void process(int amount);
}

class KakaoPayProcessor implements PaymentProcessor {
    public void process(int amount) { ... }
}

class NaverPayProcessor implements PaymentProcessor {
    public void process(int amount) { ... }
}

class PaymentService {
    private final PaymentProcessor processor;

    public PaymentService(PaymentProcessor processor) {
        this.processor = processor;
    }

    public void pay(int amount) {
        processor.process(amount);
    }
}

// 실제 사용시 필요한 객체만 주입해주면 됨.
new PaymentService(new NaverPayProcessor());
```

### 의존관계역전원칙(DIP)

- 의존 방향을 뒤집는다는 의미
- 규칙
  - 상위 모듈은 하위 모듈에 의존하면 안된다. → 둘 다 추상화에 의존해야함.
  - 추상화는 세부 사항에 의존하면 x, 세부 사항은 추상화에 따라 달라져야 함.
- 장점
  - 외부에서 모듈 생성해 집어넣는 구조라 모듈을 쉽게 교체 가능
    - dev.add(new Back())
  - 단위 테스팅, 마이그레이션 쉬워짐
  - 애플리케이션 의존성 방향이 좀 더 일관되어 코드 추론 쉬워짐
- 단점
  - 결국 모듈이 더 생겨서 복잡성 증가
  - 종석성 주입을 런타임 때 해서 컴파일 때 에러 잡기 힘들다.
